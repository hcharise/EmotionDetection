# Emotion Recognition with DeepFace

This repository contains the code and resources for an emotion recognition research project using DeepFace. The paper, [An Analysis of Gender Biases in Emotion Recognition Software Performance](https://github.com/hcharise/EmotionDetection/blob/main/An%20Analysis%20of%20Gender%20Biases%20in%20Emotion%20Recognition%20Software%20Performance.pdf), explores how emotion recognition performance differs across genders using images from the Facial Expression Recognition (FER-2013) dataset.

<img width="995" alt="Screenshot 2024-10-13 at 2 25 57 PM" src="https://github.com/user-attachments/assets/e1213f83-dbb7-4e3c-bb64-07e96eb6992c">

*Image from https://peerj.com/articles/cs-1216/*

This program was developed in PyCharm, using [this tutorial]([url](https://www.edlitera.com/blog/posts/emotion-detection-in-images)) as a starting point. The research was conducted for Syracuse University's CIS 663 Biometrics course under Professor Dr. Gregory Wagner during the July 2024 term.

## Program Files

- **`main.py`**: The main script that processes images from the FER-2013 dataset and uses DeepFace to predict the emotion in each image. It outputs initial emotion predictions for each image and logs them in the `predictions.txt` file.

- - **`make_predictions.py`**: A helper script that attempts to run DeepFace analysis on images and prints the predicted gender and emotion (if a face was successfully detected) in the `predictions.txt` file.
  
- **`parse_emotion.py`**: A helper script that compares the predicted emotion to the true emotion (encoded in the image file name). It checks if the predicted emotion matches the expected emotion and logs the results (both the prediction and whether it is correct) in the `results.txt` file.

## Output Files

- **`predictions.txt`**: Contains the initial emotion predictions generated by `main.py` for each image in the dataset.
<p align="center">
<img width="486" alt="Screenshot 2024-10-13 at 2 22 08 PM" src="https://github.com/user-attachments/assets/799f1968-ddd0-4078-83f2-9b5c20ade379">
</p>

- **`results.txt`**: Stores the final results, which include the predicted emotion and whether or not the prediction was accurate, as determined by `parse_emotion.py`.
<p align="center">
<img width="477" alt="Screenshot 2024-10-13 at 2 21 33 PM" src="https://github.com/user-attachments/assets/6c47b538-740b-4840-8e24-1f120facafde">
</p>

## Usage

1. Download the [FER 2013 dataset]([url](https://www.kaggle.com/datasets/msambare/fer2013)) (or similar photo dataset).
2. Using PyCharm or similar Python IDE, run `main.py` to predict the emotions from the images in the dataset. This also executes `parse_emotion.py` to validate the predictions against the true emotions embedded in the image file names.
3. Check `predictions.txt` and `results.txt` for the output of the predictions and their accuracy.

## Research Paper

The accompanying research paper investigates the presence of gender biases in emotion recognition software. You can find a detailed analysis of the experiment and results [here](https://github.com/hcharise/EmotionDetection/blob/main/An%20Analysis%20of%20Gender%20Biases%20in%20Emotion%20Recognition%20Software%20Performance.pdf).
